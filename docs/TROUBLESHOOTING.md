# ุฏููู ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ูุญููุง
# Troubleshooting Guide

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

ูุฐุง ุงูุฏููู ูุณุงุนุฏู ูู ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ ุงูุชู ูุฏ ุชูุงุฌููุง ุนูุฏ ุงุณุชุฎุฏุงู ุงููุธุงู ูุน Supabase.

---

## ๐ง ูุดุงูู ุงูุฅุนุฏุงุฏ ูุงูุชูููู

### 1. ูุดุงูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ

#### ุงููุดููุฉ: ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุบูุฑ ูุญุฏุฏุฉ
```
Error: Required environment variable VITE_SUPABASE_URL is not set
```

**ุงูุญู:**
1. ุชุฃูุฏ ูู ูุฌูุฏ ููู `.env.development`
2. ุชุญูู ูู ุตุญุฉ ุฃุณูุงุก ุงููุชุบูุฑุงุช:
   ```env
   VITE_SUPABASE_URL=https://your-project.supabase.co
   VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
   VITE_ENABLE_SUPABASE=true
   ```
3. ุฃุนุฏ ุชุดุบูู ุฎุงุฏู ุงูุชุทููุฑ

#### ุงููุดููุฉ: ููู ุฎุงุทุฆุฉ ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ
```
Error: Invalid URL format for VITE_SUPABASE_URL
```

**ุงูุญู:**
- ุชุฃูุฏ ูู ุฃู URL ูุจุฏุฃ ุจู `https://`
- ุชุฃูุฏ ูู ุฃู URL ููุชูู ุจู `.supabase.co`
- ูุซุงู ุตุญูุญ: `https://abcdefghijklmnop.supabase.co`

---

## ๐ ูุดุงูู ุงูุงุชุตุงู

### 1. ูุดู ุงูุงุชุตุงู ุจู Supabase

#### ุงููุดููุฉ: ุฎุทุฃ DNS
```
Error: getaddrinfo ENOTFOUND your-project.supabase.co
```

**ุงูุญู:**
1. ุชุญูู ูู ุตุญุฉ URL ุงููุดุฑูุน
2. ุชุฃูุฏ ูู ุงุชุตุงู ุงูุฅูุชุฑูุช
3. ุฌุฑุจ ุงููุตูู ููุฑุงุจุท ูู ุงููุชุตูุญ
4. ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูุฌุฏุงุฑ ุงููุงุฑู

#### ุงููุดููุฉ: ุงูุชูุงุก ูููุฉ ุงูุงุชุตุงู
```
Error: timeout of 5000ms exceeded
```

**ุงูุญู:**
1. ุชุญูู ูู ุณุฑุนุฉ ุงูุฅูุชุฑูุช
2. ุฌุฑุจ ุชุบููุฑ ููุทูุฉ Supabase
3. ุฒูุงุฏุฉ ูููุฉ ุงูุงุชุตุงู ูู ุงูููุฏ:
   ```javascript
   const client = createClient(url, key, {
     db: { schema: 'public' },
     auth: { persistSession: true },
     global: { headers: { 'x-my-custom-header': 'my-app-name' } },
     realtime: { timeout: 10000 }
   });
   ```

### 2. ูุดุงูู ุงููุตุงุฏูุฉ

#### ุงููุดููุฉ: ููุชุงุญ API ุบูุฑ ุตุญูุญ
```
Error: Invalid API key
```

**ุงูุญู:**
1. ุชุญูู ูู ุตุญุฉ `VITE_SUPABASE_ANON_KEY`
2. ุชุฃูุฏ ูู ูุณุฎ ุงูููุชุงุญ ูุงููุงู
3. ุชุญูู ูู ุนุฏู ูุฌูุฏ ูุณุงูุงุช ุฅุถุงููุฉ
4. ุฌุฑุจ ุฅูุดุงุก ููุชุงุญ ุฌุฏูุฏ ูู Supabase Dashboard

#### ุงููุดููุฉ: ุงูุชูุงุก ุตูุงุญูุฉ ุงูุฌูุณุฉ
```
Error: Auth session missing!
```

**ุงูุญู:**
1. ุชุณุฌูู ุงูุฏุฎูู ูุฑุฉ ุฃุฎุฑู
2. ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูุชูุงุก ุงูุฌูุณุฉ
3. ูุณุญ localStorage ูุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู:
   ```javascript
   localStorage.clear();
   window.location.reload();
   ```

---

## ๐๏ธ ูุดุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### 1. ูุดุงูู ุงูุฌุฏุงูู

#### ุงููุดููุฉ: ุฌุฏูู ุบูุฑ ููุฌูุฏ
```
Error: relation "table_name" does not exist
```

**ุงูุญู:**
1. ุชุฃูุฏ ูู ุชูููุฐ `database/schema.sql`
2. ุชุญูู ูู ุฃุณูุงุก ุงูุฌุฏุงูู ูู SQL Editor
3. ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู schema ุงูุตุญูุญ (`public`)

#### ุงููุดููุฉ: ุนููุฏ ุบูุฑ ููุฌูุฏ
```
Error: column "column_name" does not exist
```

**ุงูุญู:**
1. ุชุญูู ูู ูุฎุทุท ุงูุฌุฏูู
2. ุชุฃูุฏ ูู ุชูููุฐ ุฌููุน migrations
3. ูุงุฑู ูุน `database/schema.sql`

### 2. ูุดุงูู Row Level Security (RLS)

#### ุงููุดููุฉ: ุงูุชูุงู ุณูุงุณุฉ ุงูุฃูุงู
```
Error: new row violates row-level security policy
```

**ุงูุญู:**
1. ุชุฃูุฏ ูู ุชูููุฐ `database/rls_policies.sql`
2. ุชุญูู ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู ุงูุญุงูู
3. ุฑุงุฌุน ุณูุงุณุงุช RLS ููุฌุฏูู ุงููุญุฏุฏ
4. ููุงุฎุชุจุงุฑุ ูููู ุชุนุทูู RLS ูุคูุชุงู:
   ```sql
   ALTER TABLE table_name DISABLE ROW LEVEL SECURITY;
   ```

#### ุงููุดููุฉ: ุนุฏู ุงููุฏุฑุฉ ุนูู ูุฑุงุกุฉ ุงูุจูุงูุงุช
```
Error: permission denied for table users
```

**ุงูุญู:**
1. ุชุญูู ูู ูุฌูุฏ ุณูุงุณุฉ SELECT ููุฌุฏูู
2. ุชุฃูุฏ ูู ุชุณุฌูู ุงูุฏุฎูู ุจุงููุณุชุฎุฏู ุงูุตุญูุญ
3. ุฑุงุฌุน ุดุฑูุท ุงูุณูุงุณุฉ

---

## ๐ ูุดุงูู ุงูุชุฑุญูู

### 1. ูุดู ุชุฑุญูู ุงูุจูุงูุงุช

#### ุงููุดููุฉ: ุฎุทุฃ ูู ุจุฏุก ุงูุชุฑุญูู
```
Error: Migration is already running
```

**ุงูุญู:**
1. ุงูุชุธุฑ ุงูุชูุงุก ุงูุชุฑุญูู ุงูุญุงูู
2. ุฃู ุฅุนุงุฏุฉ ุชุนููู ุญุงูุฉ ุงูุชุฑุญูู:
   ```javascript
   // ูู console ุงููุชุตูุญ
   localStorage.removeItem('migration_status');
   ```

#### ุงููุดููุฉ: ูุดู ูู ุชุฑุญูู ุฌุฏูู ูุนูู
```
Error: Failed to migrate categories: duplicate key value
```

**ุงูุญู:**
1. ุชุญูู ูู ูุฌูุฏ ุจูุงูุงุช ููุฑุฑุฉ
2. ูุณุญ ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ:
   ```sql
   DELETE FROM categories WHERE id IN (SELECT id FROM categories);
   ```
3. ุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุฑุญูู

### 2. ูุดุงูู ุงูุชุญูู ูู ุงูุชุฑุญูู

#### ุงููุดููุฉ: ุนุฏู ุชุทุงุจู ุนุฏุฏ ุงูุณุฌูุงุช
```
Warning: Expected 50 records, found 45
```

**ุงูุญู:**
1. ุชุญูู ูู ุณุฌูุงุช ุงูุฃุฎุทุงุก ูู ุงูุชุฑุญูู
2. ุฑุงุฌุน ุงูุจูุงูุงุช ุงููุตุฏุฑ
3. ุฃุนุฏ ุชุดุบูู ุงูุชุฑุญูู ููุณุฌูุงุช ุงูููููุฏุฉ

---

## ๐งช ูุดุงูู ุงูุงุฎุชุจุงุฑุงุช

### 1. ูุดู ุงูุงุฎุชุจุงุฑุงุช

#### ุงููุดููุฉ: ุงุฎุชุจุงุฑุงุช Supabase ุชูุดู
```
Error: Supabase is not available
```

**ุงูุญู:**
1. ุชุฃูุฏ ูู ุชูุนูู Supabase ูู ุงูุจูุฆุฉ:
   ```env
   VITE_ENABLE_SUPABASE=true
   ```
2. ุชุญูู ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ ููุงุฎุชุจุงุฑุงุช
3. ุงุณุชุฎุฏู ุจูุงูุงุช ููููุฉ ููุงุฎุชุจุงุฑุงุช ุฅุฐุง ูุฒู ุงูุฃูุฑ

#### ุงููุดููุฉ: ุงุฎุชุจุงุฑุงุช ุจุทูุฆุฉ
```
Timeout: Test exceeded 5000ms
```

**ุงูุญู:**
1. ุฒูุงุฏุฉ ูููุฉ ุงูุงุฎุชุจุงุฑุงุช:
   ```javascript
   // ูู ููู ุงูุงุฎุชุจุงุฑ
   it('should work', async () => {
     // test code
   }, 10000); // 10 seconds timeout
   ```
2. ุงุณุชุฎุฏุงู mock data ููุงุฎุชุจุงุฑุงุช ุงูุณุฑูุนุฉ

---

## ๐ ูุดุงูู ุงูุฃุฏุงุก

### 1. ุจุทุก ูู ุชุญููู ุงูุจูุงูุงุช

#### ุงููุดููุฉ: ุงุณุชุนูุงูุงุช ุจุทูุฆุฉ
```
Warning: Query took 3000ms to complete
```

**ุงูุญู:**
1. ุฅุถุงูุฉ ููุงุฑุณ ููุฃุนูุฏุฉ ุงููุณุชุฎุฏูุฉ ูู ุงูุจุญุซ:
   ```sql
   CREATE INDEX idx_content_status ON content(status);
   ```
2. ุชุญุณูู ุงูุงุณุชุนูุงูุงุช:
   ```javascript
   // ุจุฏูุงู ูู
   const data = await supabase.from('content').select('*');
   
   // ุงุณุชุฎุฏู
   const data = await supabase
     .from('content')
     .select('id, title, excerpt')
     .limit(10);
   ```

### 2. ุงุณุชููุงู ุนุงูู ููุฐุงูุฑุฉ

#### ุงููุดููุฉ: ุชุญููู ุจูุงูุงุช ูุซูุฑุฉ
```
Warning: Large dataset detected
```

**ุงูุญู:**
1. ุงุณุชุฎุฏุงู pagination:
   ```javascript
   const { data, error } = await supabase
     .from('content')
     .select('*')
     .range(0, 9); // ุฃูู 10 ุณุฌูุงุช
   ```
2. ุชุญููู ุงูุจูุงูุงุช ุนูุฏ ุงูุญุงุฌุฉ (lazy loading)

---

## ๐ ุฃุฏูุงุช ุงูุชุดุฎูุต

### 1. ูุญุต ุญุงูุฉ ุงููุธุงู

```javascript
// ูู console ุงููุชุตูุญ
import('./src/utils/connectionTester.js').then(async (module) => {
  const result = await module.default.runTest();
  console.log('System Status:', result);
});
```

### 2. ูุญุต ูุงุนุฏุฉ ุงูุจูุงูุงุช

```javascript
// ูู console ุงููุชุตูุญ
import('./src/utils/databaseChecker.js').then(async (module) => {
  const result = await module.default.check();
  console.log('Database Status:', result);
});
```

### 3. ูุญุต ุงูุชุฑุญูู

```javascript
// ูู console ุงููุชุตูุญ
import('./src/utils/dataMigration.js').then((module) => {
  const status = module.default.getStatus();
  console.log('Migration Status:', status);
});
```

---

## ๐ ุงูุญุตูู ุนูู ุงููุณุงุนุฏุฉ

### ุฅุฐุง ูู ุชุฌุฏ ุงูุญู ููุง:

1. **ุชุญูู ูู ุงููุซุงุฆู:**
   - [ุฏููู ุฅุนุฏุงุฏ Supabase](./SUPABASE_SETUP_GUIDE.md)
   - [ุฏููู ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช](./DATABASE_SETUP_GUIDE.md)

2. **ุชุดุบูู ุงูุชุดุฎูุต ุงูุดุงูู:**
   ```bash
   npm run test:run src/tests/system-integration.test.js
   ```

3. **ุงูุชูุงุตู ูุน ุงูุฏุนู:**
   - ๐ง dev-support@sapsa.org
   - ๐ฑ +966-11-xxx-xxxx

4. **ุงูููุงุฑุฏ ุงูุฎุงุฑุฌูุฉ:**
   - [Supabase Documentation](https://supabase.com/docs)
   - [Supabase Discord](https://discord.supabase.com)

---

## ๐ ุชุณุฌูู ุงููุดุงูู

ุนูุฏ ุงูุฅุจูุงุบ ุนู ูุดููุฉุ ูุฑุฌู ุชุถููู:

1. **ูุตู ุงููุดููุฉ**
2. **ุฎุทูุงุช ุฅุนุงุฏุฉ ุงูุฅูุชุงุฌ**
3. **ุฑุณุงุฆู ุงูุฎุทุฃ ุงููุงููุฉ**
4. **ูุนูููุงุช ุงูุจูุฆุฉ:**
   ```bash
   node --version
   npm --version
   # ูุชุตูุญ ููุธุงู ุงูุชุดุบูู
   ```
5. **ูุชุงุฆุฌ ุงูุชุดุฎูุต**

---

**๐ก ูุตูุญุฉ: ุงุญุชูุธ ุจูุฐุง ุงูุฏููู ูุฑุฌุนุงู ุณุฑูุนุงู ูุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ!**
